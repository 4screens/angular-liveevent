{"version":3,"sources":["app.ts","liveevent/liveevent.ts","chat/chat.ts","bootstrap.ts","extend.ts"],"names":["Liveevent","Liveevent.Liveevent","Liveevent.Liveevent.constructor","Liveevent.Liveevent.updatePage","Liveevent.Liveevent.updateQuiz","Liveevent.Liveevent.initSocket","Liveevent.Liveevent.getById","Liveevent.Liveevent.getPageById","Liveevent.Liveevent.init","ChatModule","ChatModule.Chat","ChatModule.Chat.constructor","ChatModule.Chat.login","ChatModule.Chat.logout","ChatModule.Chat.updateChat","ChatModule.Chat.sendMsg","ChatModule.Chat.getMsgs","ChatModule.Chat.initSocket","ChatModule.Chat.init","Extension","Extension.constructor","Extension.init"],"mappings":"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AASA,EAAEA,CAACA,CAACA,IAAIA,CAACA,UAACA,GAAGA;4BAChEA,KAAIA,CAACA,UAAUA,CAACA,GAAGA,CAACA,CAACA;4BACrBA,AACAA,cADcA;4BACdA,KAAIA,CAACA,WAAWA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,IAAIA,CAACA,UAACA,IAAIA;gCAChDA,KAAIA,CAACA,UAAUA,CAACA,IAAIA,CAACA,CAACA;4BACxBA,CAACA,CAACA,CAACA;wBACLA,CAACA,CAACA,CAACA;oBACLA,CAACA;oBAACA,IAAIA,CAACA,CAACA;wBACNA,AACAA,oBADoBA;wBACpBA,OAAOA,CAACA,GAAGA,CAACA,wCAAwCA,CAACA,CAACA;wBACtDA,KAAIA,CAACA,WAAWA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,IAAIA,CAACA,UAACA,IAAIA;4BAChDA,KAAIA,CAACA,UAAUA,CAACA,IAAIA,CAACA,CAACA;wBACxBA,CAACA,CAACA,CAACA;oBACLA,CAACA;gBACHA,CAACA;YACHA,CAACA,CAACA,CAACA;QACLA,CAACA;QAEDJ,gBAAgBA;QAChBA,2BAAOA,GAAPA,UAAQA,EAAUA;YAChBK,IAAIA,GAAGA,GAAGA,SAASA,CAACA,MAAMA,CAACA,OAAOA,CAACA,MAAMA,GAAGA,SAASA,CAACA,MAAMA,CAACA,SAASA,CAACA,YAAYA,CAACA;YACpFA,GAAGA,GAAGA,GAAGA,CAACA,OAAOA,CAACA,cAAcA,EAAEA,EAAEA,CAACA,CAACA;YAEtCA,AACAA,sCADsCA;YACtCA,MAAMA,CAACA,SAASA,CAACA,KAAKA,CAACA,GAAGA,CAACA,GAAGA,CAACA,CAACA,IAAIA,CAACA,UAACA,GAA2BA;gBAC/DA,EAAEA,CAACA,CAACA,CAACA,GAAGA,EAAEA,GAAGA,CAACA,CAACA,OAAOA,CAACA,GAAGA,CAACA,MAAMA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;oBAC1CA,OAAOA,CAACA,GAAGA,CAACA,wBAAwBA,GAAGA,GAAGA,CAACA,IAAIA,C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","file":"liveevent.js","sourcesContent":["/// <reference path=\"../typings/tsd.d.ts\" />\n\nvar app = angular.module('4screens.liveevent', ['LocalStorageModule']);","/// <reference path=\"iliveevent.ts\" />\n\nmodule Liveevent {\n  export class Liveevent implements ILiveevent {\n    enabled: boolean;\n    title: string;\n\n    activePage: Page.IPage;\n    activeQuiz: Engageform.IEngageform;\n    activePageId: string;\n    activeQuizId: string;\n    socket: SocketIOClient.Socket;\n    EF: Engageform.IEngageform;\n    chat: ChatModule.IChat;\n\n    constructor() {\n      console.log('[ Liveevent ] Constructor');\n    }\n\n    private updatePage(page) {\n      console.log('[ Liveevent ] Update Page: ' + page._id);\n      this.activePage = page;\n      this.activePageId = page._id;\n      this.EF['_engageform'].initPage(page); // ts compiler ..\n\n      // Add liveSettings\n      this.EF.current.liveSettings = <Page.ILiveSetting>page.liveSettings;\n    }\n\n    private updateQuiz(EF) {\n      console.log('[ Liveevent ] Update Quiz: ' + EF._engageformId);\n      this.activeQuiz = EF;\n      this.activeQuizId = EF._engageformId;\n    }\n\n    // Sockets\n    private initSocket(opts: API.ILiveEmbed) {\n      console.log('[ Liveevent ] Init socket');\n      var url = Extension.config.backend.domain + Extension.config.liveEvent.socketNamespace;\n      url = url.replace(':liveEventId', opts.id);\n      this.socket = Extension.io.connect(url);\n\n      this.socket.on('connect', () => {\n        console.log('[ Liveevent:Socket ] Connected');\n        this.socket.emit('getStatus', { liveEventId: opts.id });\n      });\n\n      this.socket.on('disconnect', this.initSocket);\n\n      this.socket.on('liveEventStatus', (data) => {\n\n        // Init chat if Liveevent has one\n        // FIXME: Uncomment chatId checking\n        if (!this.chat /*&& data.chatId*/) {\n          // FIXE: Remove fake chat id #55c1f03de5498601002e0c9e and get rid of socketio injection\n          // this.chat = new ChatModule.ChatModule(data.chatId);\n\n          this.chat = new ChatModule.Chat('55c1f03de5498601002e0c9e');\n          this.chat.init();\n        }\n\n        if (data.activeQuestionId !== this.activePageId || data.activeQuizId !== this.activeQuizId) {\n          // Quiz changed\n          if (data.activeQuizId !== this.activeQuizId) {\n            console.log('[ Liveevent:Socket ] Quiz changed');\n            // return Engageform.Engageform.getById(data.activeQuizId).then((quizData) => {\n            //   this.updateQuiz(quizData);\n            // });\n\n            this.EF.init({ id: data.activeQuizId, mode: 'default' }).then((res) => {\n              this.updateQuiz(res);\n              // Update Page\n              this.getPageById(data.activeQuestionId).then((page) => {\n                this.updatePage(page);\n              });\n            });\n          } else {\n            // Only Page changed\n            console.log('[ Liveevent:Socket ] Only Page changed');\n            this.getPageById(data.activeQuestionId).then((page) => {\n              this.updatePage(page);\n            });\n          }\n        }\n      });\n    }\n\n    // Get Liveevent\n    getById(id: string): ng.IPromise<API.ILiveevent> {\n      var url = Extension.config.backend.domain + Extension.config.liveEvent.liveEventUrl;\n      url = url.replace(':liveEventId', id);\n\n      // TODO: Get quiz and current question\n      return Extension.$http.get(url).then((res: API.ILiveeventResponse) => {\n        if ([200, 304].indexOf(res.status) !== -1) {\n          console.log('[ Liveevent ] Get LE: ' + res.data._id);\n          return res.data;\n        }\n\n        return Extension.$q.reject(res);\n      });\n    }\n\n    // Get Page\n    private getPageById(questionId: string) {\n      var url = Extension.config.backend.domain + Extension.config.liveEvent.activeQuestion;\n      url = url.replace(':questionId', questionId);\n\n      return Extension.$http.get(url).then(function(res) {\n\n        if ([200, 304].indexOf(res.status) !== -1) {\n          console.log('[ Liveevent ] Get PAGE: ' + res.data['_id']);\n          return res.data;\n        }\n\n          this.$q.reject(res);\n      });\n    }\n\n    init(opts: API.ILiveEmbed) {\n      console.log('[ Liveevent ] Init: ' + opts.id);\n      var deferred = Extension.$q.defer();\n\n      this.EF = opts.engageform;\n\n      // Init socket\n      this.initSocket(opts);\n\n      deferred.resolve(this);\n      return deferred.promise;\n    }\n  }\n}\n","/// <reference path=\"ichat.ts\" />\n\nmodule ChatModule {\n  export class Chat implements IChat {\n    id: string;\n    name: string;\n    premoderated: boolean;\n    socket: SocketIOClient.Socket;\n    messages: IMessage[] = [];\n    user: IUser;\n\n    constructor(id: string) {\n      console.log('[ Chat ] Constructor');\n      this.id = id;\n\n      return this;\n    }\n\n    private login(data: IFbAuth, dataMe: any) { // FIXME: dateMe FB interface (v2.3 or 2.2) ?\n      this.user = {\n        accessToken: data.accessToken,\n        user: data.userID, // FIXME: What i should pass here (in old version it was userId) ?!\n        userLink: dataMe.link,\n        userName: dataMe.name,\n        userID: data.userID\n      };\n    }\n\n    private logout():void {\n      this.user = null;\n    }\n\n    private updateChat(data) {\n      console.log('[ Chat ] Update chat');\n      this.id = data.id;\n      this.name = data.name;\n      this.premoderated = data.premoderated;\n\n      // Get some old msgs\n      this.getMsgs();\n    }\n\n    private sendMsg(m: IMessage) {\n      console.log('[ Chat ] Posting msg');\n\n      if (!this.user) return;\n\n      var url = Extension.config.backend.domain + Extension.config.chat.sendUrl, msg;\n      url = url.replace(':chatId', this.id);\n\n      msg = {\n        accessToken: this.user.accessToken,\n        date: Date.now(),\n        hidden: false,\n        id: this.user.userId,\n        msg: m,\n        user: this.user.user,\n        userLink: this.user.userLink,\n        userName: this.user.userName\n      };\n\n      Extension.$http.post(url, msg).then((res) => {\n        this.messages.push(msg);\n      });\n    }\n\n    private getMsgs() {\n      console.log('[ Chat ] Get old msgs');\n      var url = Extension.config.backend.domain + Extension.config.chat.messagesUrl;\n      url = url.replace(':chatId', this.id);\n      return Extension.$http.get(url).then((res) => {\n        //console.log('[ Chat ] Got ' + res.data.length + ' msgs');\n        this.messages = <IMessage[]>res.data;\n      });\n    }\n\n    private initSocket() {\n      console.log('[ Chat:Socket ] Init socket');\n\n      var url = Extension.config.backend.socket;\n\n      this.socket = Extension.io.connect(url, { 'force new connection': true });\n\n      this.socket.on('error', (res) => {\n        console.log(res);\n      });\n\n      console.info(url);\n      console.info(this.socket);\n\n      this.socket.on('connect', (data) => {\n        console.log('[ Chat:Socket ] Connected');\n\n        // Join room\n        this.socket.emit('joinRoom', this.id);\n        // We can also leave room, to do so just emit 'leaveRoom' with roomId as param\n      });\n\n      // New msg event\n      this.socket.on('msg', (data) => {\n        console.log('[ Chat:Socket ] New msg');\n      });\n\n      // On disconect\n      this.socket.on('disconnect', this.initSocket);\n    }\n\n    init():void {\n      console.log('[ Chat ] Init: ' + this.id);\n\n      // Get chat details\n      var url = Extension.config.backend.domain + Extension.config.chat.detailUrl;\n      url = url.replace(':chatId', this.id);\n      Extension.$http.get(url).then((res: IChatResponse) => {\n        this.updateChat(res.data);\n        this.initSocket();\n      });\n    }\n  }\n}\n","/// <reference path=\"api/api.ts\" />\n/// <reference path=\"liveevent/liveevent.ts\" />\n/// <reference path=\"chat/chat.ts\" />\n\nclass Extension {\n  static $http: ng.IHttpService;\n  static $q: ng.IQService;\n  static localStorage: ng.local.storage.ILocalStorageService;\n  static config;\n  static io: SocketIOClientStatic;\n  Liveevent: Liveevent.ILiveevent;\n\n  constructor($http: ng.IHttpService, $q: ng.IQService, localStorage: ng.local.storage.ILocalStorageService, ApiConfig) {\n    Extension.$http = $http;\n    Extension.$q = $q;\n    Extension.localStorage = localStorage;\n    Extension.config = ApiConfig;\n  }\n\n  init(opts: API.ILiveEmbed) {\n    Extension.io = <SocketIOClientStatic>opts.io;\n\n    var liveevent = new Liveevent.Liveevent;\n    return liveevent.init(opts);\n  }\n}\n\nExtension.$inject = ['$http', '$q', 'localStorageService', 'ApiConfig'];\napp.service('Liveevent', Extension);\n","/// <reference path=\"api/iembed.ts\" />\n/// <reference path=\"api/iquizquestion.ts\" />\n/// <reference path=\"api/iquizquestionsres.ts\" />\n/// <reference path=\"api/iquizquestionanswer.ts\" />\n/// <reference path=\"api/iquizquestionanswerres.ts\" />\n/// <reference path=\"api/iquiz.ts\" />\n/// <reference path=\"api/iquizres.ts\" />\n/// <reference path=\"api/iquizfinish.ts\" />\n/// <reference path=\"api/iquizfinishres.ts\" />\n\n/// <reference path=\"page/enum.ts\" />\n/// <reference path=\"page/icase.ts\" />\n/// <reference path=\"page/ipage.ts\" />\n/// <reference path=\"page/ipages.ts\" />\n/// <reference path=\"page/ipagesent.ts\" />\n/// <reference path=\"page/isettings.ts\" />\n\n/// <reference path=\"engageform/enum.ts\" />\n/// <reference path=\"engageform/iengageform.ts\" />\n/// <reference path=\"engageform/isettings.ts\" />\n/// <reference path=\"engageform/itheme.ts\" />\n\n/// <reference path=\"branding/ibranding.ts\" />\n\n/// <reference path=\"navigation/inavigation.ts\" />"],"sourceRoot":"/source/"}